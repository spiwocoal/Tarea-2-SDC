\section{Pregunta \texttt{h)}}\label{pregunta-h}
\subsection{Desarrollo}

A continuación, se pide repetir lo realizado en los apartados \hyperref[pregunta-c]{\texttt{c)}},
\hyperref[pregunta-d]{\texttt{d)}}, \hyperref[pregunta-e]{\texttt{e)}},
\hyperref[pregunta-f]{\texttt{f)}} y \hyperref[pregunta-g]{\texttt{g)}}, para un
controlador integrador con función de transferencia $h_{c}(s) = \mora{k_{c}} \mathbin{/} s$.

Entonces, para obtener los polos y ceros en L.D. y en L.C. se empieza por determinar
las F. de T. que definen este nuevo sistema. Para el lazo directo entonces, se
tiene,
\begin{gather}
    l(s) = \frac{\mora{k_{c}}}{s} \nara{k_{st}k_{a}} \frac{\rojo{\psi(s)}}{\verd{v_{i}(s)}} \\
    l(s) = \frac{\mora{k_c} \nara{k_{a}k_{st}} \nara{b_{0\omega}}\left(\nara{b_{1\psi}}s
            + \nara{b_{0\psi}}\right)}
        {s \left(\nara{a_{1\omega}}s + \nara{a_{0\omega}}\right)\left(\nara{a_{2\psi}}s^{2}
            + \nara{a_{1\psi}}s + \nara{a_{0\psi}} \right)} 
\end{gather}

Luego, se utiliza \textit{MATLAB} para determinar los polos y ceros, y se obtiene:

\begin{multicols}{2}
    \textbf{Polos}
    \begin{itemize}
        \item \(P_0 = 0 \)
        \item \(P_{1,2} = -0.6597 \pm 8.8564j\) 
        \item \(P_3 = -1.5152 \)
    \end{itemize}

    \columnbreak

    \textbf{Ceros}
    \begin{itemize}
        \item \(Z_0 = -4.4609\)
    \end{itemize}
\end{multicols}

A continuación, para el lazo cerrado, la función de transferencia es,
\begin{gather}
    h(s) = \frac{h_{c}(s)\nara{k_{a}}\frac{\rojo{\psi(s)}}{\verd{v_{i}(s)}}}
        {1 + h_{c}(s)\nara{k_{st}k_{a}}\frac{\rojo{\psi(s)}}{\verd{v_{i}(s)}}} \\
    h(s) = \frac{\mora{k_c}\nara{k_a}\nara{b_{0\omega}}\left(\nara{b_{1\psi}}s
            + \nara{b_{0\psi}}\right)}
        {s\left(\nara{a_{1\omega}}s + \nara{a_{0\omega}}\right)\left(\nara{a_{2\psi}}s^{2}
            + \nara{a_{1\psi}}s + \nara{a_{0\psi}}\right) + \mora{k_c}\nara{k_{a}k_{st}b_{0\omega}}
            \left(\nara{b_{1\psi}}s + \nara{b_{0\psi}}\right)}
\end{gather}

Resolviendo con \textit{MATLAB}, se obtiene el valor de los polos y ceros de esta F. de T:

\begin{multicols}{2}
    \textbf{Polos}
    \begin{itemize}
        \item \(P_{0,1} = -0.4593 \pm 8.7836j\)
        \item \(P_{2,3} = -0.9580 \pm 0.9117j\)
    \end{itemize}

    \columnbreak

    \textbf{Ceros}
    \begin{itemize}
        \item \(Z_0 = -4.4609\)
    \end{itemize}
\end{multicols}

\begin{figure}[ht]
    \centering
    \input{Diagramas/lgr_h1.tex}
    \caption{Lugar geométrico de las raíces para el sistema con controlador integrador.}
    \label{fig:lgr-h1}
\end{figure}

Luego, deseamos graficar el L.G.R. del sistema realimentado. Entonces, se repite
el procedimiento realizado en \hyperref[pregunta-d]{\texttt{d)}}, mediante el
comando \verb|rlocus|. Entonces, el lugar geométrico de las raíces para el sistema
estudiado con controlador integrador es aquel de la \autoref{fig:lgr-h1}. \\

A continuación, se buscan valores de $\mora{k_{c}}$ para los cuales el sistema se
comporta como de primer y segundo orden estable. Entonces, se quiere que la razón
entre las partes reales de las raíces del sistema sea igual a $10$. Repitiendo
el procedimiento utilizado anteriormente para lograr esto, con F. de T. de lazo
\begin{equation}
    l(s) = \frac{3033s + 13531}{s\left(s^{3} + 2.83s^{2} + 80.87s + 119.5\right)}
\end{equation}

Las raíces del sistema en L.C. están entonces dadas por
\begin{equation}
    1 + \mora{k_{c}}\frac{3033s + 13531}{s\left(s^{3} + 2.83s^{2} + 80.87s + 119.5\right)} = 0
\end{equation}

Así, se utiliza \textit{MATLAB} para obtener los valores de $\mora{k_{c}}$ que
permiten que $\mathfrak{Re}(\lambda_{0}) = 10\mathfrak{Re}(\lambda_{1})$, siendo
$\lambda_{0}, \lambda_{1}$ dos raíces del sistema. El valor encontrado es entonces
que, para que el sistema se comporte como uno de segundo orden, el valor de
$\mora{k_{c}}$ debe ser:
\begin{equation}
    \boxed{\mora{k_{c}} = 0.0253}
\end{equation}

Se grafica nuevamente el L.G.R. y se observa entonces que para las ganancias dadas,
se tienen los siguientes polos:
\begin{itemize}
    \item $\lambda_{0,1} = -1.2885 \pm 1.6913j$
    \item $\lambda_{2,3} = -0.1288 \pm 8.6988j$
\end{itemize}

Se observa que no hay valor negativo de $\mora{k_{c}}$ para el cual sea posible
reducir el orden del sistema, manteniendo estabilidad puesto que para ganancias
negativas, el sistema siempre tendrá un polo en el S.P.D. \\

Luego, utilizando el mismo comando que se utilizó para el caso previo, se obtienen
valores de $\mora{k_{c}}$ tales que el sistema sea marginalmente estable. Del lugar
geométrico de las raíces (\autoref{fig:lgr-h2}), podemos observar que para este sistema,
con controlador integrador, existirá un único valor de $\mora{k_{c}}$ para que
el sistema sea marginalmente estable, el cual será positivo. Entonces, el valor
que se encontró es:
\begin{equation}
    \boxed{\mora{k_{c}} = 0.0310}
\end{equation}

Además, se puede observar que debido al controlador, el sistema cuenta con un
polo en el origen, por lo que para $\mora{k_{c}} = 0$ se podría decir que el
sistema también es marginalmente estable.

\begin{figure}[ht]
    \centering
    \input{Diagramas/lgr_h2.tex}
    \caption{Lugar geométrico de las raíces para el sistema con controlador integrador.}
    \label{fig:lgr-h2}
\end{figure}

Calculamos entonces los polos del sistema para esta ganancia:
\begin{itemize}
    \item $\lambda_{0,1} = -1.4178 \pm 1.8868$
    \item $\lambda_{2,3} = \pm 8.6778$ \\
\end{itemize}

Recopilando toda esta información, podemos entonces concluir que para que el
sistema sea estable, la ganancia debe ser positiva, puesto que para todo valor
negativo de $\mora{k_{c}}$, el sistema cuenta con polos en el S.P.D.

Entonces, puesto que el sistema se hace marginalmente estable para $\mora{k_{c}} = 31\unit{m}$,
el intervalo para el cual el sistema es estable es,
\begin{equation}
    \boxed{0 \leq \mora{k_{c}} \leq 31\unit{m}}
\end{equation}

Luego, el sistema es estable y se comporta como un sistema de segundo orden, o
bien, es oscilatorio para entrada escalón, para ganancias que se encuentran en
el intervalo
\begin{equation}
    \boxed{25.3\unit{m} \leq \mora{k_{c}} \leq 31\unit{m}}
\end{equation}

\FloatBarrier
\subsection{Comentarios}

\textbf{!AQUÍ COMENTARIOS NO OLVIDAR!}
Posibles Comentarios
\begin{itemize}
    \item Idem (c), (d), (e), (f) y (g) comparando con el controlador de ganancia
\end{itemize}


 En el caso de analizar el sistema con un controlador de tipo integrador (\(\mora{k_c}/s\)), observamos algunos cambios con respecto al Controlador proporcional. Al comparar los polos y ceros en L.D. y L.C., se mantiene el cero en el mismo lugar que en el caso con el controlador proporcional, dado que el integrador no afecta esta posición y como mencionamos depende netamente de la planta. Sin embargo, en L.D añade un polo en el origen que modifica la dinámica del sistema. Esto se traduce en una respuesta de mayor persistencia en la dinámica, con tendencia a eliminar el error en estado estacionario como se ha visto en clases, y como vimos en la tarea 1 es capaz de llegar a la entrada de referencia.

Ademas con L.G.R. vemos que gracias al ser con controlador integrador, en este caso el sistema es estable solo en un rango positivo de ganancias (\(\mora{k_c}\)) solamente. Ya que en el negativo gracias al polo que se genera en el origen, donde si el \(\mora{k_c}\) fuera menor que $0$ se haría inestable, ya que un polo pasaría al semiplano Derecho.

En resumen con el L.G.R se obtiene el análisis de estabilidad donde dio el rango de \(0 \leq \mora{k_{c}} \leq 31\unit{m}\) muestra que la respuesta del sistema puede controlarse efectivamente con valores de ganancia adecuados, proporcionando una respuesta más estable y sin oscilaciones no deseadas en el régimen estacionario.
